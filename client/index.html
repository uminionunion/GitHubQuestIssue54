
<!--
AI PROMPT TO RECREATE THIS FEATURE IN HTML, CSS, JS, SQL, PHP:

**Objective:** Create a comprehensive, single-page web application feature called "PantryFinder". This tool allows users to find various local resources (pantries, political representatives) on an interactive map and submit new pantry locations. The entire feature should operate within a large modal window.

**Technology Stack:**
-   **Frontend:** Plain HTML5, CSS3, and JavaScript (ES6+).
-   **Mapping Library:** Leaflet.js.
-   **Backend:** PHP (latest stable version) for API endpoints.
-   **Database:** MySQL or MariaDB.

---

### **Part 1: Database Schema (SQL)**

Define three tables in your MySQL/MariaDB database.

1.  **`pantries` table:** Stores user-submitted pantry information.
    -   `id` (INT, PRIMARY KEY, AUTO_INCREMENT)
    -   `name` (VARCHAR(255), NOT NULL)
    -   `address` (VARCHAR(255), NOT NULL)
    -   `lat` (DECIMAL(10, 8), NOT NULL)
    -   `lng` (DECIMAL(11, 8), NOT NULL)
    -   `hours` (VARCHAR(255))
    -   `notes` (TEXT)
    -   `type` (ENUM('food', 'clothing', 'resource', 'library'), NOT NULL)
    -   `repeating` (ENUM('one-time', 'daily', 'weekly', 'weekendly', 'monthly', 'idk'), NOT NULL)
    -   `deleted` (BOOLEAN, DEFAULT 0) - Use this as a soft-delete flag.
    -   `created_at` (TIMESTAMP, DEFAULT CURRENT_TIMESTAMP)

2.  **`politicians` table:** Stores data for political representatives.
    -   `id` (INT, PRIMARY KEY, AUTO_INCREMENT)
    -   `name` (VARCHAR(255), NOT NULL)
    -   `office` (ENUM('House', 'Senate'), NOT NULL)
    -   `state` (VARCHAR(2), NOT NULL)
    -   `district` (INT, NULL) - `NULL` for Senators.
    -   `party` (VARCHAR(50))
    -   `term_end_date` (DATE)
    -   `lat` (DECIMAL(10, 8), NOT NULL)
    -   `lng` (DECIMAL(11, 8), NOT NULL)

3.  **`candidates` table:** Stores data for political candidates.
    -   `id` (INT, PRIMARY KEY, AUTO_INCREMENT)
    -   `name` (VARCHAR(255), NOT NULL)
    -   `office` (ENUM('House', 'Senate'), NOT NULL)
    -   `state` (VARCHAR(2), NOT NULL)
    -   `district` (INT, NULL)
    -   `party` (VARCHAR(50))
    -   `lat` (DECIMAL(10, 8), NOT NULL)
    -   `lng` (DECIMAL(11, 8), NOT NULL)

---

### **Part 2: Backend API (PHP)**

Create a directory named `api` to house the PHP scripts. All endpoints must handle Cross-Origin Resource Sharing (CORS) and return data in JSON format.

1.  **`data.php` (`GET`):** A versatile endpoint to fetch data.
    -   Accepts a `type` query parameter (e.g., `/api/data.php?type=pantries`).
    -   If `type=pantries`, select all records from the `pantries` table where `deleted = 0`.
    -   If `type=politicians`, select all records from the `politicians` table.
    -   If `type=candidates`, select all records from the `candidates` table.
    -   Return the results as a JSON array.

2.  **`pantry.php` (`POST`):** Handles new pantry submissions.
    -   Accepts a JSON payload with all required pantry fields.
    -   Perform server-side validation to ensure all required fields are present and valid.
    -   Use prepared statements (e.g., with `mysqli` or `PDO`) to securely insert the data into the `pantries` table. This is critical for preventing SQL injection.
    -   Return the newly created pantry object (including its new `id`) as JSON with a `201 Created` status code.

3.  **`geocode.php` (`GET`):** Geocoding service proxy.
    -   Accepts an `address` query parameter.
    -   Make a server-to-server request to a free geocoding API like OpenStreetMap Nominatim. **Important:** Include a proper User-Agent header in your request as required by Nominatim's usage policy.
    -   Parse the response and return a JSON object containing `{ lat, lng }`.

---

### **Part 3: Frontend Structure (HTML & CSS)**

**1. Main Page (`index.html`):**
-   **Layout:** A centered, vertical layout.
-   **Buttons:** Two prominent buttons: "Find a Pantry" and "#13UnionSupportV001".
-   **Map Preview:** Below the buttons, include a small `div` for a map preview. This `div` should be about 75% smaller than the main modal map. It should be non-interactive (no zoom, drag, or popups).
-   **Modal Trigger:** Clicks on either of the buttons OR the map preview should trigger the main modal.

**2. Main Modal (Dynamically shown/hidden with JS):**
-   **Styling:** The modal should be a large overlay (e.g., 90vw width, 90vh height) with a dark background and rounded corners.
-   **Layout:** A two-column layout using CSS Flexbox or Grid.
    -   **Left Column (Map):** Takes up 2/3 of the width. This will contain the Leaflet map.
    -   **Right Column (Controls):** Takes up 1/3 of the width. This is the control panel.

**3. Styling (CSS):**
-   **Theme:** Implement a dark theme as the default and only theme. Use dark background colors (`#0f172a`), light text (`#f8fafc`), and blue for primary actions (`#3b82f6`).
-   **Responsiveness:** Ensure the layout adapts gracefully to smaller screens. On mobile, the two columns in the modal might stack vertically.
-   **Leaflet Popups:** Style the Leaflet popups to match the dark theme (dark background, light text).

---

### **Part 4: Frontend Logic (JavaScript)**

**1. Initialization:**
-   On page load, fetch initial pantry data from `/api/data.php?type=pantries` and populate the preview map.
-   When the modal is opened for the first time, fetch all data (`pantries`, `politicians`, `candidates`) and initialize the main interactive map.

**2. Map Logic (Leaflet.js):**
-   **Initialization:** Create a Leaflet map instance in the left column of the modal, centered on the USA. Use OpenStreetMap tiles.
-   **Marker Icons:** Create custom `L.Icon` instances for each marker type with distinct colors:
    -   Pantry (Food): Green
    -   Pantry (Clothing): Blue
    -   Pantry (Resource): Purple
    -   Pantry (Library): Black
    -   Politician (House): Dark Gray
    -   Politician (Senate): Light Gray
    -   Candidate: Gold (add a CSS class for a glowing effect: `box-shadow: 0 0 15px gold;`).
-   **Marker Rendering:**
    -   Write a function that takes an array of items (pantries, politicians, etc.) and adds them to the map.
    -   Each marker should have a popup bound to it, displaying its details (name, address, etc.).
    -   The pantry popups should include a "View Details" button.
-   **Filtering:** Create a master function `updateMapMarkers()` that clears all existing markers and re-renders only the ones that match the currently selected categories in the "Find a Pantry" view.

**3. Control Panel Logic:**
-   **View Switching:** The "Find a Pantry" and "Know-of a Pantry?" buttons should toggle the visibility of the corresponding views within the control panel.
-   **"Find a Pantry" View:**
    -   **Category Checkboxes:** Attach event listeners to the category checkboxes. When a checkbox state changes, update a global array of selected categories and call `updateMapMarkers()`.
    -   **Location Filtering:** The country and state radio buttons are for UI display; implementing the geographic filtering logic is a next step.
-   **"Host a Pantry" Form:**
    -   **AI Geo-Finder:** The "magic wand" button next to the address input should trigger an async function that:
        1.  Takes the text from the address input.
        2.  Calls your `/api/geocode.php` endpoint.
        3.  Populates the Latitude and Longitude input fields with the response.
    -   **Form Submission:**
        1.  Add a `submit` event listener to the form.
        2.  Prevent the default form submission.
        3.  Create a JavaScript object from the form data.
        4.  `POST` this object as JSON to `/api/pantry.php`.
        5.  On a successful response, add the new pantry to your local data array, switch the view back to "Find a Pantry", and call `updateMapMarkers()` to show the new pin.
-   **"Pantry Details" View:**
    -   When the "View Details" button in a pantry's popup is clicked, switch the control panel to a "Details" view.
    -   This view should display all information for the selected pantry (name, address, hours, notes, type, repeating).
-->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" content="#ffffff" />
    <title>#13- Find a Pantry Button</title>
  </head>
  <body>
    <div id="root" class="contents"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
